{"ast":null,"code":"import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container d-flex justify-content-center\"\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"div\", {\n  style: {\n    \"width\": \"80%\"\n  },\n  class: \"border mt-5\"\n}, [/*#__PURE__*/_createElementVNode(\"div\")], -1 /* HOISTED */);\nconst _hoisted_3 = [_hoisted_2];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, _hoisted_3);\n}","map":{"version":3,"mappings":";;EAEOA,KAAK,EAAC;AAAyC;gCAClDC,oBAKM;EALDC,KAAkB,EAAlB;IAAA;EAAA,CAAkB;EAACF,KAAK,EAAC;iBAC5BC,oBAEM;oBAHRE,UAKM;;uBANRC,oBAOM,OAPNC,UAOM","names":["class","_createElementVNode","style","_hoisted_2","_createElementBlock","_hoisted_1"],"sourceRoot":"","sources":["/Users/kgj/Library/Mobile Documents/com~apple~CloudDocs/공유/project/TGolShop/TGolShop/src/components/PurchaseComplete.vue"],"sourcesContent":["<template>\n  \n  <div class=\"container d-flex justify-content-center\">\n    <div style=\"width:80%;\" class=\"border mt-5\">\n      <div>\n        \n      </div>\n      \n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport { useRoute, useRouter } from 'vue-router'\nimport { ref } from 'vue';\nexport default {\n  name:'PurchaseComplete',\n  setup() {\n    const router = useRouter();\n    const route = useRoute();\n    let nickName = ref('');\n    let login = ref(true);\n    let paymentKey = new URLSearchParams(window.location.search).get('paymentKey');\n    let orderId = new URLSearchParams(window.location.search).get('orderId');\n    let amount = new URLSearchParams(window.location.search).get('amount');\n    let payMethod = ref(route.query.payMethod);\n    let purchaseInfo = ref({\n      nickName : new URLSearchParams(window.location.search).get('nickName'),\n      name : new URLSearchParams(window.location.search).get('name'),\n      phoneNum : new URLSearchParams(window.location.search).get('phoneNum'),\n      addressNum : new URLSearchParams(window.location.search).get('addressNum'),\n      address : new URLSearchParams(window.location.search).get('address'),\n      addressName : new URLSearchParams(window.location.search).get('addressName'),\n      detailAddress : new URLSearchParams(window.location.search).get('detailAddress'),\n      productId : new URLSearchParams(window.location.search).get('productId'),\n      productName : new URLSearchParams(window.location.search).get('productName'),\n      orderNum : new URLSearchParams(window.location.search).get('orderNum'),\n      optionText : new URLSearchParams(window.location.search).get('optionText'),\n      totalPrice : new URLSearchParams(window.location.search).get('totalPrice'),\n      payPrice : new URLSearchParams(window.location.search).get('payPrice'),\n      leavedPoint : new URLSearchParams(window.location.search).get('leavedPoint'),\n      payMethod : new URLSearchParams(window.location.search).get('payMethod'),\n      orderId : orderId,\n      realPay : amount\n    })\n    const headers = {\n      'Authorization': 'Basic dGVzdF9za196WExrS0V5cE5BcldtbzUwblgzbG1lYXhZRzVSOg==',\n      'Content-Type': 'application/json'\n    };\n\n    // 결제승인 API 호출\n    const data = {\n      paymentKey: paymentKey,\n      amount: amount,\n      orderId: orderId\n    };\n    \n    axios.post('https://api.tosspayments.com/v1/payments/confirm', data, { headers })\n    .then(response => {\n      console.log(response.data);\n      return axios.post('/api/product/submitReport', response.data);\n    })\n    .then(()=>{\n      return axios.post('/api/product/purchase', purchaseInfo.value);\n    })\n    .then(()=>{\n      return axios.get('/api/product/submit')\n    })\n    .then(result=>{\n      if(result.data === 'need login') {\n        login.value = false;\n      } else nickName.value = result.data;\n    })\n    .catch(error => {\n      console.error(error);\n    });\n    \n   \n    \n\n    function clickHome() {\n      router.push({path : '/'});\n    }\n    function clickPurchaseList() {\n      router.push({name : 'MyPage', query : {nickName : nickName.value, cart : 0}});\n    }\n    return {clickHome, clickPurchaseList, orderId, login, payMethod};\n  }\n}\n</script>\n\n<style>\n\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}