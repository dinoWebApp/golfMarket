{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container d-flex justify-content-center\"\n};\nconst _hoisted_2 = {\n  style: {\n    \"width\": \"80%\"\n  },\n  class: \"border mt-5\"\n};\nconst _hoisted_3 = {\n  class: \"ms-1 me-1\"\n};\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"div\", {\n  style: {\n    \"font-size\": \"large\"\n  },\n  class: \"d-none d-sm-block mt-5 mb-3\"\n}, \" 구매를 성공적으로 완료하였습니다. \", -1 /* HOISTED */);\nconst _hoisted_5 = /*#__PURE__*/_createElementVNode(\"div\", {\n  style: {\n    \"font-size\": \"medium\"\n  },\n  class: \"d-block d-sm-none mt-5 mb-3\"\n}, \" 구매를 성공적으로 완료하였습니다. \", -1 /* HOISTED */);\nconst _hoisted_6 = {\n  key: 0,\n  class: \"mb-3\"\n};\nconst _hoisted_7 = {\n  style: {\n    \"font-size\": \"small\"\n  }\n};\nconst _hoisted_8 = /*#__PURE__*/_createElementVNode(\"div\", {\n  style: {\n    \"color\": \"red\",\n    \"font-size\": \"small\"\n  }\n}, \"(비회원께서는 주문 조회를 위해 반드시 숙지하셔야 합니다.)\", -1 /* HOISTED */);\nconst _hoisted_9 = {\n  key: 1,\n  class: \"mb-3\"\n};\nconst _hoisted_10 = /*#__PURE__*/_createElementVNode(\"div\", {\n  style: {\n    \"font-size\": \"small\"\n  }\n}, \"무통장 입금 계좌: 대구은행 508-10-844784-5 티골프 피팅(김수환)\", -1 /* HOISTED */);\nconst _hoisted_11 = {\n  style: {\n    \"font-size\": \"small\"\n  }\n};\nconst _hoisted_12 = /*#__PURE__*/_createElementVNode(\"div\", {\n  style: {\n    \"color\": \"red\",\n    \"font-size\": \"small\"\n  }\n}, \"입금자 명과 주문정보가 일치해야 합니다.\", -1 /* HOISTED */);\nconst _hoisted_13 = /*#__PURE__*/_createElementVNode(\"div\", {\n  style: {\n    \"color\": \"red\",\n    \"font-size\": \"small\"\n  }\n}, \"주문 날짜로부터 3일 내에 입금 처리가 되지 않으면 자동으로 주문 취소 처리됩니다.\", -1 /* HOISTED */);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_hoisted_4, _hoisted_5, $setup.login === false ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, \"주문 번호: \" + _toDisplayString($setup.orderId), 1 /* TEXT */), _createTextVNode(), _hoisted_8])) : _createCommentVNode(\"v-if\", true), $setup.payMethod === '무통장입금' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [_hoisted_10, _createElementVNode(\"div\", _hoisted_11, \"입금 금액: \" + _toDisplayString($setup.price) + \"원\", 1 /* TEXT */), _hoisted_12, _hoisted_13])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"button\", {\n    onClick: _cache[0] || (_cache[0] = (...args) => $setup.clickHome && $setup.clickHome(...args)),\n    style: {\n      \"font-weight\": \"bold\",\n      \"font-size\": \"large\"\n    },\n    class: \"btn btn-danger me-1 mb-5 mt-2\"\n  }, \"홈으로\"), $setup.login ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 2,\n    onClick: _cache[1] || (_cache[1] = (...args) => $setup.clickPurchaseList && $setup.clickPurchaseList(...args)),\n    style: {\n      \"font-weight\": \"bold\",\n      \"font-size\": \"large\"\n    },\n    class: \"btn btn-success ms-1 mb-5 mt-2\"\n  }, \"주문목록\")) : _createCommentVNode(\"v-if\", true)])])]);\n}","map":{"version":3,"mappings":";;EAEOA,KAAK,EAAC;AAAyC;;EAC7CC,KAAkB,EAAlB;IAAA;EAAA,CAAkB;EAACD,KAAK,EAAC;;;EACvBA,KAAK,EAAC;AAAW;gCACpBE,oBAEM;EAFDD,KAAwB,EAAxB;IAAA;EAAA,CAAwB;EAACD,KAAK,EAAC;GAA8B,sBAElE;gCACAE,oBAEM;EAFDD,KAAyB,EAAzB;IAAA;EAAA,CAAyB;EAACD,KAAK,EAAC;GAA8B,sBAEnE;;;EACKA,KAAK,EAAC;;;EACJC,KAAyB,EAAzB;IAAA;EAAA;AAAyB;gCAA0BC,oBAAiF;EAA5ED,KAAoC,EAApC;IAAA;IAAA;EAAA;AAAoC,GAAC,mCAAiC;;;EAEhID,KAAK,EAAC;;iCACTE,oBAAgF;EAA3ED,KAAyB,EAAzB;IAAA;EAAA;AAAyB,GAAC,6CAA2C;;EACrEA,KAAyB,EAAzB;IAAA;EAAA;AAAyB;iCAC9BC,oBAAsE;EAAjED,KAAoC,EAApC;IAAA;IAAA;EAAA;AAAoC,GAAC,wBAAsB;iCAChEC,oBAA8F;EAAzFD,KAAoC,EAApC;IAAA;IAAA;EAAA;AAAoC,GAAC,gDAA8C;;;uBAhBhGE,oBAuBM,OAvBNC,UAuBM,GAtBJF,oBAqBM,OArBNG,UAqBM,GApBJH,oBAkBM,OAlBNI,UAkBM,GAjBJC,UAEM,EACNC,UAEM,EACkBC,YAAK,4BAA7BN,oBAEM,OAFNO,UAEM,GADJR,oBAAuD,OAAvDS,UAAuD,EAAxB,SAAO,oBAAEF,cAAO,sCAASG,UAAiF,yCAEnHH,gBAAS,8BAAjCN,oBAKM,OALNU,UAKM,GAJJC,WAAgF,EAChFZ,oBAAwD,OAAxDa,WAAwD,EAAzB,SAAO,oBAAGN,YAAK,IAAG,GAAC,iBAClDO,WAAsE,EACtEC,WAA8F,yCAEhGf,oBAA0H;IAAjHgB,OAAK,yCAAET,6CAAS;IAAER,KAA4C,EAA5C;MAAA;MAAA;IAAA,CAA4C;IAACD,KAAK,EAAC;KAAgC,KAAG,GACnGS,YAAK,kBAAnBN,oBAAiJ;;IAA3He,OAAK,yCAAET,6DAAiB;IAAER,KAA4C,EAA5C;MAAA;MAAA;IAAA,CAA4C;IAACD,KAAK,EAAC;KAAiC,MAAI","names":["class","style","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","$setup","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","onClick"],"sourceRoot":"","sources":["/Users/kgj/Library/Mobile Documents/com~apple~CloudDocs/공유/project/TGolShop/TGolShop/src/components/PurchaseComplete.vue"],"sourcesContent":["<template>\n  \n  <div class=\"container d-flex justify-content-center\">\n    <div style=\"width:80%;\" class=\"border mt-5\">\n      <div class=\"ms-1 me-1\">\n        <div style=\"font-size:large;\" class=\"d-none d-sm-block mt-5 mb-3\">\n          구매를 성공적으로 완료하였습니다.\n        </div>\n        <div style=\"font-size:medium;\" class=\"d-block d-sm-none mt-5 mb-3\">\n          구매를 성공적으로 완료하였습니다.\n        </div>\n        <div class=\"mb-3\" v-if=\"login === false\">\n          <div style=\"font-size: small;\">주문 번호: {{orderId}}</div> <div style=\"color:red; font-size: small;\">(비회원께서는 주문 조회를 위해 반드시 숙지하셔야 합니다.)</div>\n        </div>\n        <div class=\"mb-3\" v-if=\"payMethod === '무통장입금'\">\n          <div style=\"font-size: small;\">무통장 입금 계좌: 대구은행 508-10-844784-5 티골프 피팅(김수환)</div>\n          <div style=\"font-size: small;\">입금 금액: {{ price }}원</div>\n          <div style=\"color:red; font-size: small;\">입금자 명과 주문정보가 일치해야 합니다.</div>\n          <div style=\"color:red; font-size: small;\">주문 날짜로부터 3일 내에 입금 처리가 되지 않으면 자동으로 주문 취소 처리됩니다.</div>\n        </div>\n        <button @click=\"clickHome\" style=\"font-weight: bold; font-size: large;\" class=\"btn btn-danger me-1 mb-5 mt-2\">홈으로</button>\n        <button v-if=\"login\" @click=\"clickPurchaseList\" style=\"font-weight: bold; font-size: large;\" class=\"btn btn-success ms-1 mb-5 mt-2\">주문목록</button>\n      </div>\n      \n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport { useRoute, useRouter } from 'vue-router'\nimport { ref } from 'vue';\nexport default {\n  name:'PurchaseComplete',\n  setup() {\n    const router = useRouter();\n    const route = useRoute();\n    let nickName = ref('');\n    let login = ref(true);\n    let paymentKey = new URLSearchParams(window.location.search).get('paymentKey');\n    let orderId = ref(route.query.orderId);\n    let amount = new URLSearchParams(window.location.search).get('amount');\n    let payMethod = ref(route.query.payMethod);\n    let price = ref(route.query.price);\n    let purchaseInfo = ref({\n      nickName : new URLSearchParams(window.location.search).get('nickName'),\n      name : new URLSearchParams(window.location.search).get('name'),\n      phoneNum : new URLSearchParams(window.location.search).get('phoneNum'),\n      addressNum : new URLSearchParams(window.location.search).get('addressNum'),\n      address : new URLSearchParams(window.location.search).get('address'),\n      addressName : new URLSearchParams(window.location.search).get('addressName'),\n      detailAddress : new URLSearchParams(window.location.search).get('detailAddress'),\n      productId : route.query.productId,\n      productName : route.query.productName,\n      orderNum : route.query.orderNum,\n      optionText : route.query.optionText,\n      severalPrice : route.query.severalPrice,\n      totalPrice : new URLSearchParams(window.location.search).get('totalPrice'),\n      payPrice : new URLSearchParams(window.location.search).get('payPrice'),\n      leavedPoint : new URLSearchParams(window.location.search).get('leavedPoint'),\n      payMethod : new URLSearchParams(window.location.search).get('payMethod'),\n      orderId : orderId.value,\n      realPay : amount\n    });\n    const queryStr = decodeURIComponent(window.location.search.substring(1));\nconst queryParams = JSON.parse(queryStr);\n    const headers = {\n      'Authorization': 'Basic dGVzdF9za196WExrS0V5cE5BcldtbzUwblgzbG1lYXhZRzVSOg==',\n      'Content-Type': 'application/json'\n    };\n    console.log(route.query.cartId);\n\n    // 결제승인 API 호출\n    const data = {\n      paymentKey: paymentKey,\n      amount: amount,\n      orderId: orderId.value\n    };\n\n    axios.get('/api/product/submit')\n    .then(result=>{\n      if(result.data === 'need login') {\n        login.value = false;\n        if(route.query.cashOrderId) {\n          orderId.value = route.query.cashOrderId;\n        }\n      } else nickName.value = result.data;\n    })\n    .catch(error => {\n      console.error(error);\n    });\n\n    if (paymentKey) {\n      axios.post('https://api.tosspayments.com/v1/payments/confirm', data, { headers })\n      .then(response => {\n        console.log(response.data);\n        return axios.post('/api/product/submitReport', response.data);\n      })\n      .then(()=>{\n        if(route.query.cartBool) {\n          purchaseInfo.value.cartBool = true;\n          purchaseInfo.value.cartId = route.query.cartId;\n          return axios.post('/api/product/cartPurchase')\n        } else return axios.post('/api/product/purchase', purchaseInfo.value);\n      })\n      .catch(error => {\n        console.error(error);\n      });\n    }\n    \n    \n   \n    \n\n    function clickHome() {\n      router.push({path : '/'});\n    }\n    function clickPurchaseList() {\n      router.push({name : 'MyPage', query : {nickName : nickName.value, cart : 0}});\n    }\n    return {clickHome, clickPurchaseList, orderId, login, payMethod, price};\n  }\n}\n</script>\n\n<style>\n\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}