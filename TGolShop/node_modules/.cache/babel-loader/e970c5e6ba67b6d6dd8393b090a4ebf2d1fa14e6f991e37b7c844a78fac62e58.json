{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from 'axios';\nimport { useRouter } from 'vue-router';\nimport { ref } from 'vue';\nexport default {\n  name: 'PurchaseComplete',\n  setup() {\n    const router = useRouter();\n    let nickName = ref('');\n    let login = ref(true);\n    let paymentKey = new URLSearchParams(window.location.search).get('paymentKey');\n    let orderId = new URLSearchParams(window.location.search).get('orderId');\n    let amount = new URLSearchParams(window.location.search).get('amount');\n    let purchaseInfo = ref({\n      nickName: new URLSearchParams(window.location.search).get('nickName'),\n      name: new URLSearchParams(window.location.search).get('name'),\n      phoneNum: new URLSearchParams(window.location.search).get('phoneNum'),\n      addressNum: new URLSearchParams(window.location.search).get('addressNum'),\n      address: new URLSearchParams(window.location.search).get('address'),\n      addressName: new URLSearchParams(window.location.search).get('addressName'),\n      detailAddress: new URLSearchParams(window.location.search).get('detailAddress'),\n      productId: new URLSearchParams(window.location.search).get('productId'),\n      productName: new URLSearchParams(window.location.search).get('productName'),\n      orderNum: new URLSearchParams(window.location.search).get('orderNum'),\n      optionText: new URLSearchParams(window.location.search).get('optionText'),\n      totalPrice: new URLSearchParams(window.location.search).get('totalPrice'),\n      payPrice: new URLSearchParams(window.location.search).get('payPrice'),\n      leavedPoint: new URLSearchParams(window.location.search).get('leavedPoint'),\n      orderId: orderId,\n      realPay: amount\n    });\n    const headers = {\n      'Authorization': 'Basic dGVzdF9za196WExrS0V5cE5BcldtbzUwblgzbG1lYXhZRzVSOg==',\n      'Content-Type': 'application/json'\n    };\n\n    // 결제승인 API 호출\n    const data = {\n      paymentKey: paymentKey,\n      amount: amount,\n      orderId: orderId\n    };\n    axios.post('https://api.tosspayments.com/v1/payments/confirm', data, {\n      headers\n    }).then(response => {\n      console.log(response.data);\n      return axios.post('/api/product/submitReport', response.data);\n    }).then(response => {\n      console.log(response.data);\n      return axios.post('api/product/purchase', purchaseInfo.value);\n    }).then(() => {\n      return axios.get('/api/product/submit');\n    }).then(result => {\n      if (result.data === 'need login') {\n        login.value = false;\n      } else nickName.value = result.data;\n    }).catch(error => {\n      console.error(error);\n    });\n    function clickHome() {\n      router.push({\n        path: '/'\n      });\n    }\n    function clickPurchaseList() {\n      router.push({\n        name: 'MyPage',\n        query: {\n          nickName: nickName.value,\n          cart: 0\n        }\n      });\n    }\n    return {\n      clickHome,\n      clickPurchaseList,\n      orderId,\n      login\n    };\n  }\n};","map":{"version":3,"mappings":"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","names":["axios","useRouter","ref","name","setup","router","nickName","login","paymentKey","URLSearchParams","window","location","search","get","orderId","amount","purchaseInfo","phoneNum","addressNum","address","addressName","detailAddress","productId","productName","orderNum","optionText","totalPrice","payPrice","leavedPoint","realPay","headers","data","post","then","response","console","log","value","result","catch","error","clickHome","push","path","clickPurchaseList","query","cart"],"sourceRoot":"","sources":["/Users/kgj/Library/Mobile Documents/com~apple~CloudDocs/공유/project/TGolShop/TGolShop/src/components/PurchaseComplete.vue"],"sourcesContent":["<template>\n  \n  <div class=\"container d-flex justify-content-center\">\n    <div style=\"width:80%;\" class=\"border mt-5\">\n      \n      <div style=\"font-size:large;\" class=\"d-none d-sm-block mt-5 mb-3\">\n        구매를 성공적으로 완료하였습니다.\n      </div>\n      <div style=\"font-size:medium;\" class=\"d-block d-sm-none mt-5 mb-3\">\n        구매를 성공적으로 완료하였습니다.\n      </div>\n      <div class=\"mb-3\" v-if=\"login === false\">\n        <div style=\"font-size: small;\">주문 번호: {{orderId}}</div> <div style=\"color:red; font-size: small;\">(비회원께서는 주문 조회를 위해 반드시 숙지하셔야 합니다.)</div>\n      </div>\n      <button @click=\"clickHome\" style=\"font-weight: bold; font-size: large;\" class=\"btn btn-danger me-1 mb-5 mt-2\">홈으로</button>\n      <button v-if=\"login\" @click=\"clickPurchaseList\" style=\"font-weight: bold; font-size: large;\" class=\"btn btn-success ms-1 mb-5 mt-2\">주문목록</button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport { useRouter } from 'vue-router'\nimport { ref } from 'vue';\nexport default {\n  name:'PurchaseComplete',\n  setup() {\n    const router = useRouter();\n    let nickName = ref('');\n    let login = ref(true);\n    let paymentKey = new URLSearchParams(window.location.search).get('paymentKey');\n    let orderId = new URLSearchParams(window.location.search).get('orderId');\n    let amount = new URLSearchParams(window.location.search).get('amount');\n    let purchaseInfo = ref({\n      nickName : new URLSearchParams(window.location.search).get('nickName'),\n      name : new URLSearchParams(window.location.search).get('name'),\n      phoneNum : new URLSearchParams(window.location.search).get('phoneNum'),\n      addressNum : new URLSearchParams(window.location.search).get('addressNum'),\n      address : new URLSearchParams(window.location.search).get('address'),\n      addressName : new URLSearchParams(window.location.search).get('addressName'),\n      detailAddress : new URLSearchParams(window.location.search).get('detailAddress'),\n      productId : new URLSearchParams(window.location.search).get('productId'),\n      productName : new URLSearchParams(window.location.search).get('productName'),\n      orderNum : new URLSearchParams(window.location.search).get('orderNum'),\n      optionText : new URLSearchParams(window.location.search).get('optionText'),\n      totalPrice : new URLSearchParams(window.location.search).get('totalPrice'),\n      payPrice : new URLSearchParams(window.location.search).get('payPrice'),\n      leavedPoint : new URLSearchParams(window.location.search).get('leavedPoint'),\n      orderId : orderId,\n      realPay : amount\n    })\n    const headers = {\n      'Authorization': 'Basic dGVzdF9za196WExrS0V5cE5BcldtbzUwblgzbG1lYXhZRzVSOg==',\n      'Content-Type': 'application/json'\n    };\n\n    // 결제승인 API 호출\n    const data = {\n      paymentKey: paymentKey,\n      amount: amount,\n      orderId: orderId\n    };\n    \n    axios.post('https://api.tosspayments.com/v1/payments/confirm', data, { headers })\n    .then(response => {\n      console.log(response.data);\n      return axios.post('/api/product/submitReport', response.data);\n    })\n    .then((response)=>{\n      console.log(response.data);\n      return axios.post('api/product/purchase', purchaseInfo.value);\n    })\n    .then(()=>{\n      return axios.get('/api/product/submit')\n    })\n    .then(result=>{\n      if(result.data === 'need login') {\n        login.value = false;\n      } else nickName.value = result.data;\n    })\n    .catch(error => {\n      console.error(error);\n    });\n    \n   \n    \n\n    function clickHome() {\n      router.push({path : '/'});\n    }\n    function clickPurchaseList() {\n      router.push({name : 'MyPage', query : {nickName : nickName.value, cart : 0}});\n    }\n    return {clickHome, clickPurchaseList, orderId, login};\n  }\n}\n</script>\n\n<style>\n\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}